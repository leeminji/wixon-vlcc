<!DOCTYPE HTML>
<html lang="ko">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<meta name="description" content="">
	<meta name="author" content="">
	<title>VLCCLAB Dashboard - SELINE</title>
	<link rel="shortcut icon" type="image/x-icon" href="../_public/favicon.ico" />
	<!-- stylesheet -->
	<link href="../_public/vendor/scrollbar/scrollbar.css" rel="stylesheet" type="text/css" />
	<link href="../_public/css/style.css" rel="stylesheet" type="text/css" />
</head>
<body>
	<div class="loading" id="loading"><div class="img"><span class="skip">Loading...</span></div></div>
	<!-- Layout__Allwrap : class = active_submenu : SideMenu 있는경우에만 class 추가 -->
	<div class="Layout__Allwrap" id="LayoutAllwrap">
		<!-- header -->
		<header class="Layout__header">
			<!-- Layout__menu -->
			<div class="Layout__menu">
				<div class="TotalMenu__tooltip" id="totalMenuTooltip"></div>
				<!-- TotalMenu -->
				<div class="TotalMenu black" id="totalMenu">
					<div class="js-scrollbar">
						<div class="TotalMenu__top">				
							<a href="javascript:;" class="TotalMenu__button_menu" id="totalMenuOpen"><span class="icon icon_menu"></span></a>
							<div class="AdminState">
								<a href="#" title="" class="AdminState__state">
									<span class="icon icon_admin"></span> <span class="txt">ADMIN LOGOUT</span>
								</a>
							</div>
							<a href="javascript:;" class="TotalMenu__button_close" title="close" id="totalMenuClose"><span class="icon icon_close"></span></a>
						</div>
						<!-- TotalMenu__listArea -->
						<nav class="TotalMenu__listArea">
							<h1 class="skip">전체메뉴</h1>
							<ul class="clear TotalMenu__list" id="totalMenuList">
								<li data-title="Setting">
									<a href="#">
										<span class="icon icon_setting on"></span>
										<span class="txt">Setting</span>
									</a>
								</li>
								<li data-title="Dashbaord">
									<a href="2_dashboard.html">
										<span class="icon icon_moniter on"></span>
										<span class="txt">Dashbaord</span>
									</a>
								</li>
								<li data-title="Map" class="active">
									<a href="3_map.html">
										<span class="icon icon_location on"></span>
										<span class="txt">Map</span>
									</a>
								</li>
								<li data-title="Spot Charter">
									<a href="4_spot_charter.html">
										<span class="icon icon_compass on"></span>
										<span class="txt">Spot Charter</span>
									</a>
									<ul class="clear TotalMenu__sublist">
										<li><a href=""><span class="txt">Position list</span></a></li>
										<li><a href=""><span class="txt">Nowcast</span></a></li>
										<li><a href=""><span class="txt">Pattern</span></a></li>
										<li><a href=""><span class="txt">Analysis</span></a></li>
									</ul>
								</li>
								<li data-title="Tool">
									<a href="#">
										<span class="icon icon_ruler on"></span>
										<span class="txt">Tool</span>
									</a>
									<ul class="clear TotalMenu__sublist">
										<li><a href=""><span class="txt">TCE Estimation</span></a></li>
										<li><a href=""><span class="txt">Distance</span></a></li>
									</ul>					
								</li>
								<li data-title="Market Report">
									<a href="#">
										<span class="icon icon_doc on"></span>
										<span class="txt">Market Report</span>
									</a>
									<ul class="clear TotalMenu__sublist">
										<li><a href=""><span class="txt">Freight Assessment</span></a></li>
										<li><a href=""><span class="txt">Tonne Miles</span></a></li>
										<li><a href=""><span class="txt">Fleet Study</span></a></li>
										<li><a href=""><span class="txt">Bunker</span></a></li>
									</ul>					
								</li>
								<li data-title="OIL">
									<a href="#">
										<span class="icon icon_water on"></span>
										<span class="txt">OIL</span>
									</a>
									<ul class="clear TotalMenu__sublist">
										<li><a href=""><span class="txt">Flow</span></a></li>
										<li><a href=""><span class="txt">Inventory</span></a></li>
										<li><a href=""><span class="txt">Weekly Report</span></a></li>
									</ul>					
								</li>
								<li data-title="My Fleet">
									<a href="#">
										<span class="icon icon_ship on"></span>
										<span class="txt">My Fleet</span>
									</a>
									<ul class="clear TotalMenu__sublist">
										<li><a href=""><span class="txt">Management</span></a></li>
									</ul>		
								</li>
								<li data-title="Mailing">
									<a href="9_mail.html">
										<span class="icon icon_mail on"></span>
										<span class="txt">Mailing</span>
									</a>
								</li>
							</ul>
						</nav>
						<!-- //TotalMenu__listArea -->				
					</div>
				</div>
				<!-- //TotalMenu -->
			</div>
			<!-- //Layout__menu -->
		</header>
		<!-- //header -->
		<!-- Layout__container -->
		<div class="Layout__container bgStyle_01">
			<div class="Layout__topContent">
				<!-- TopTitle -->
				<div class="TopTitle font_condensed"><span>map</span></div>
				<!-- //TopTitle -->			
				<div class="TopLogin white">
					<a href="0_index.html" class="TopLogin__state"><span class="icon icon_admin"></span><span class="txt">ADMIN LOGOUT</span></a>
				</div>
				<!-- TopSearch -->
				<div class="TopSearch left white">
					<div class="TopSearch__inner">
						<input type="text" title="Search" id="top_stx" class="TopSearch__input" />
						<label for="top_stx" class="TopSearch__label"><span>Search</span></label>
						<ul class="TopSearch__list" style="display: none;">
							<li><a href="">MAP SERECH RESULT - 1</a></li>
							<li><a href="">MAP SERECH RESULT - 2</a></li>
							<li><a href="">MAP SERECH RESULT - 3</a></li>
							<li><a href="">MAP SERECH RESULT - 4</a></li>
						</ul>	
					</div>
				</div>
				<!-- //TopSearch -->
				<div class="TopLogo"><a href="0_index.html" class="link">메인으로이동</a><h1 class="skip">VLCCLAB</h1></div>
			</div>	
			<!-- MapArea 대시보드 -->
			<section class="Layout__content MapArea">
				<h1 class="skip">MAP Contents</h1>
				<div class="Layout__content__inner noPadding" id="MapContent">
					<!-- 구글맵 영역 -->
					<div id="totalMap" class="MapTotalSize"></div>
					<!-- //구글맵 영역 -->
					<!-- MapControl -->
					<div class="MapControl">
						<a href="#" class="move"><span>move</span></a>
						<a href="#" class="ruler"><span>ruler</span></a>
						<a href="#" class="camera"><span>camera</span></a>
						<a href="#" class="marker"><span>marker</span></a>
					</div>
					<!-- //MapControl -->
					<!-- MapZoomButton -->
					<div class="MapZoomButton">
						<a href="#" class="zoomIn"><span>Zoom In</span></a>
						<a href="#" class="zoomOut"><span>Zoom Out</span></a>
						<a href="#" class="mapView"><span>view</span></a>
					</div>
					<!-- //MapControl -->
					<!-- MapButton -->
					<div class="MapButton">
						<div class="MapButton__item"><a href="javascript:;" onclick="window.uiGooglMap.state().open();"><span>vlcc status</span></a></div>
						<div class="MapButton__item"><a href="javascript:;" onclick="window.uiGooglMap.menu().open();"><span>menu</span></a></div>
					</div>
					<!-- //MapButton -->
					<!-- MapState -->
					<div class="MapState active" id="MapState">
						<a href="javascript:;" onclick="window.uiGooglMap.state().close();" class="MapState__button_close" id="MapStateClose"><span class="icon icon_close_thin"></span></a>
						<div class="MapState__inner">
							<div class="MapState__title"><span>VLCC STATUS</span></div>
							<ul class="clear clearix MapState__list">
								<li>
									<div class="MapState__item">
										<span class="js-svg iconShip" data-icon="ship_1"></span>
										<span class="txt">On Sub / Fixed / Project</span>
									</div>
								</li>
								<li class="narrow">
									<div class="MapState__item">
										<span class="js-svg iconShip" data-icon="ship_2"></span>
										<span class="txt">Laden</span>
									</div>
								</li>
								<li>
									<div class="MapState__item">
										<span class="js-svg iconShip" data-icon="ship_3"></span>
										<span class="txt">Open soon</span>
									</div>
								</li>
								<li>
									<div class="MapState__item">
										<span class="js-svg iconShip" data-icon="ship_4"></span>
										<span class="txt">Open (Handicaped)</span>
									</div>
								</li>
								<li>
									<div class="MapState__item">
										<span class="js-svg iconShip" data-icon="ship_5"></span>
										<span class="txt">Drydock / Others</span>
									</div>
								</li>
								<li class="narrow">
									<div class="MapState__item">
										<span class="js-svg iconShip" data-icon="ship_6"></span>
										<span class="txt">Open </span>
									</div>
								</li>
								<li>
									<div class="MapState__item">
										<span class="js-svg iconShip" data-icon="ship_7"></span>
										<span class="txt">Floating Storag</span>
									</div>
								</li>
								<li>
									<div class="MapState__item">
										<span class="js-svg iconShip" data-icon="ship_8"></span>
										<span class="txt">Open soon (handicapped)</span>
									</div>
								</li>
							</ul>
						</div>
					</div>
					<!-- //MapState -->
					<!-- MapMenu -->
					<div class="MapMenu active" id="MapMenu">
						<a href="javascript:;" onclick="window.uiGooglMap.menu().close();" class="MapMenu__button_close" id="MapMenuClose"><span class="skip">닫기</span><span class="icon icon_arrow03_next"></span></a>
						<div class="MapMenu__inner">
							<div class="MapMenu__list">
								<div class="title"><span>All Vessels</span></div>
								<ul class="clear MapMenu__sublist">
									<li><a href="">Ballast+Laden</a></li>
									<li><a href="">Ballast</a></li>
									<li class="active"><a href="">Laden</a></li>
								</ul>
							</div>
							<div class="MapMenu__list">
								<div class="title"><span>Ballast Only</span></div>
								<ul class="clear MapMenu__sublist">
									<li><a href="">On Sub / Fixed</a></li>
									<li><a href="">Project</a></li>
									<li><a href="">Open</a></li>
									<li><a href="">Open Soon</a></li>
									<li><a href="">Drydock</a></li>
									<li><a href="">Others</a></li>
								</ul>
							</div>								
							<div class="MapMenu__list">
								<div class="title"><span>Laden Only</span></div>
								<ul class="clear MapMenu__sublist">
									<li><a href="">Loading</a></li>
									<li><a href="">In Transit</a></li>
									<li><a href="">Floating Storafge</a></li>
								</ul>
							</div>
						</div>
					</div>
					<!-- //MapMenu -->
					<!-- MapShipInfo 클릭했을때 -->
					<div class="MapShipInfo animated" id="MapShipInfo">
						<div class="MapShipInfo__inner">
							<a href="javascript:;" onclick="window.uiGooglMap.infoShipMarker().close();" class="MapShipInfo__close"><span>닫기</span></a>
							<div class="MapShipInfo__title">
								<div class="mark"><a class="icon icon_star" href="javascript:;"></a></div>
								<div class="name">Yuan Qiu Hu</div>
								<div class="date">Canaport 21 Sep 19</div>
								<div class="etc"><span>308.371</span><span>2015</span><span>Scrubber fitted</span></div>
							</div>
							<div class="MapShipInfo__content">
								<ul class="clear MapShipInfo__list">
									<li><span class="tit">Draft</span><span class="txt">11/ -9.4m(50% of max) 7d 58min ago</span></li>
									<li><span class="tit">Speed</span><span class="txt">13.2 / +1.6 kts (9% of max) 15h 12min ago</span></li>
									<li><span class="tit">Heading</span><span class="txt">83</span></li>
									<li><span class="tit">Dest/ETA</span><span class="txt">Guangzhou / 03 Dec 19</span></li>
									<li><span class="tit">Long/Lat</span><span class="txt">23,1888 / -34,9713</span></li>
									<li class="signal"><span class="tit">Last signal</span><span class="txt">17min ago</span></li>
									<li><span class="tit">Status</span><span class="txt">Open</span></li>
									<li><span class="tit">Last Port</span><span class="txt">CAPE for 4d</span></li>
									<li><span class="tit">Operator</span><span class="txt">SK Shipping</span></li>
									<li><span class="tit">Charterer</span><span class="txt">Unipec</span></li>
								</ul>
							</div>
						</div>
					</div>
					<!-- //MapShipInfo 클릭했을때 -->

					<!-- 200403 추가 MapPathLine 클릭했을때 -->
					<div class="MapPathLineInfo" id="MapPathLineInfo">
						<div class="MapPathLineInfo__inner">
							<a href="javascript:;" onclick="showPathInfo.close();" class="MapPathLineInfo__close"><span>닫기</span></a>
							<div class="MapPathLineInfo__content">
								<ul class="clear MapPathLineInfo__list">
									<li>Open</li>
									<li>loading</li>
									<li>intrasit</li>
									<li>discharging</li>
								</ul>
							</div>
						</div>
					</div>
					<!-- //200403 추가 MapPathLine 클릭했을때 -->

					<!-- MapDetail -->
					<div class="MapDetail" id="MapDetail">
						<div class="MapDetail__list">
							<a href="#MapDetailMap"><span>Map</span></a>
							<a href="#MapDetailWeather"><span>Weather</span></a>
							<a href="#MapDetailStorm"><span>Storm</span></a>
							<a href="#MapDetailRoute"><span>Route</span></a>
						</div>
						<div class="MapDetail__content">
							<div class="MapDetail__inner" id="MapDetailMap">
								<div class="MapDetail__layers">
									<div class="MapDetail__title"><span>Layers</span></div>
									<ul class="clear">
										<li class="row"><label class="SlideCheckbox smaller"><input type="checkbox" checked><span></span></label> <span class="label">ECA</span></li>
										<li class="row"><label class="SlideCheckbox smaller"><input type="checkbox"><span></span></label> <span class="label">PIRACY</span></li>
										<li class="row"><label class="SlideCheckbox smaller"><input type="checkbox"><span></span></label> <span class="label">JWC</span></li>
										<li class="row"><label class="SlideCheckbox smaller"><input type="checkbox"><span></span></label> <span class="label">HIGH RISK PIRACY</span></li>
										<li class="row"><label class="SlideCheckbox smaller"><input type="checkbox"><span></span></label> <span class="label">TSS</span></li>
										<li class="row"><label class="SlideCheckbox smaller"><input type="checkbox"><span></span></label> <span class="label">TSS2</span></li>
									</ul>
								</div>
							</div>
							<div class="MapDetail__inner" id="MapDetailWeather">
								weather...
							</div>
							<div class="MapDetail__inner" id="MapDetailStorm">
								Storm...
							</div>
							<div class="MapDetail__inner" id="MapDetailRoute">
								<div class="MapDetail__title"><span>Layers</span></div>
								<ul class="clear">
									<li class="row"><label class="SlideCheckbox smaller"><input type="checkbox" checked><span></span></label> <span class="label">Suez Canal</span></li>
									<li class="row"><label class="SlideCheckbox smaller"><input type="checkbox"><span></span></label> <span class="label">Malacca Strait</span></li>
									<li class="row"><label class="SlideCheckbox smaller"><input type="checkbox"><span></span></label> <span class="label">Sunda Strait</span></li>
									<li class="row"><label class="SlideCheckbox smaller"><input type="checkbox"><span></span></label> <span class="label">Taiwan Strit</span></li>
								</ul>
							</div>
						</div>
					</div>
					<!-- //MapDetail -->
				</div>
			</section>
			<!-- //MapArea 대시보드 -->
		</div>
		<!-- //Layout__container -->
		<!-- footer -->
		<footer class="Layout__footer"></footer>
		<!-- //footer -->
	</div>
	<!-- javascript -->
	<script type="text/javascript" src="../_public/js/jquery-1.12.4.js"></script>
	<script type="text/javascript" src="../_public/js/jquery-ui.js"></script>
	<script type="text/javascript" src="../_public/vendor/scrollbar/jquery.scrollbar.js"></script>
	<script type="text/javascript" src="../_public/js/ui.js"></script>
	<!-- 맵 js 추가 -->
	<script type="text/javascript">
		$(document).ready(function(){
			//window.ui.init();
			
			//마크 On/Off : className : on 으로 제어
			$('.icon_star').on('click', function(){
				$(this).toggleClass('on');
			});
			
			ui_mapDetail();
		});

		var sampleData = {
			"line_list":{
				"coordinates": [
					{lat: 15.933509, lng: 81.705314}, 
					{lat : 19.160335, lng : 88.916407},
					{lat: 15.091604, lng: 96.180620}, 
					{lat: 0.704153, lng: 104.684426},
					{lat : 12.834711, lng : 111.434909},
					{lat: 21.280128, lng:  114.058712},
					{lat : 22.665475, lng : 117.492517},
					{lat: 27.201494, lng :122.496629},
					{lat: 36.051769, lng: 120.342220},
				]
			},
			"ship_list":[
				{
					"myfleet" : true,
					"ship_type" : "ship_1",
					"mmsi":205073000,
					"vessel_name":"NEWTON",
					"position_info":{
						"lat":15.933509,
						"lon":81.705314,
						"turn":0.0,
						"speed":0.1,
						"course":281.4,
						"true_heading":56,
					}
				}, {
					"myfleet" : false,
					"ship_type" : "ship_3",
					"mmsi":205073001,
					"vessel_name":"SIMONE",
					"position_info":{
						"lat":12.834711,
						"lon":111.434909,
						"turn":0.0,
						"speed":0.0,
						"course":62.7,
						"true_heading":131,
					}
				}, {
					"myfleet" : true,
					"ship_type" : "ship_6",
					"mmsi":205073003,
					"vessel_name":"SIMONE_2222",
					"position_info":{
						"lat":27.201494,
						"lon":122.496629,
						"turn":0.0,
						"speed":0.0,
						"course":62.7,
						"true_heading":50,
					}
				}, {
					"myfleet" : true,
					"ship_type" : "ship_6",
					"mmsi":205073005,
					"vessel_name":"SIMONE_4444",
					"position_info":{
						"lat":29.301594,
						"lon":122.36429,
						"turn":0.0,
						"speed":0.0,
						"course":1,
						"true_heading":30,
					}
				},{
					"myfleet" : false,
					"ship_type" : "ship_5",
					"mmsi":205073004,
					"vessel_name":"SIMONE_3333",
					"position_info":{
						"lat":36.051769,
						"lon":120.342220,
						"turn":0.0,
						"speed":0.0,
						"course":62.7,
						"true_heading":58,
					}
				}
    		]
		}
		
		//맵예시
		var _map;
		var _shipMarkers = []; //마커들 담은 리스트(필요)
		var INFO_ZOOM_LEVEL = 6;

		function initMap(){
			_map = new google.maps.Map(document.getElementById('totalMap'), {
				center: {lat: 36.705106, lng: 127},
				zoom: 5,
				styles : window.uiGooglMap.googleMapStyle,
				disableDefaultUI: true
			});

			//맵이동시 인포삭제, 인포위치이동
			_map.addListener('center_changed', function() {
				removeAllShipInfo();
				var info = window.uiGooglMap.infoShipMarker();
				info.close();
				//라인인포 삭제
				showPathInfo.close();
				zoomInfoDisplay(_map);
			});

			_map.addListener("zoom_changed", function(){
				zoomInfoDisplay(_map);
			});

			//마커, 배 표시함수
			createLine(_map, sampleData.line_list.coordinates);
			createShipMakers(_map, sampleData.ship_list);
		}

		//줌하면 인포표시하고 아웃하면 사라짐.
		function zoomInfoDisplay(_map){
			removeAllShipInfo();
			var zoomLevel = _map.getZoom();
			if( zoomLevel < INFO_ZOOM_LEVEL ) return;
			
			//현재 맵 바운드
			var bounds = _map.getBounds();
			var ne = bounds.getNorthEast(); // LatLng of the north-east corner
			var sw = bounds.getSouthWest(); // LatLng of the south-west corner
			var nw = new google.maps.LatLng(ne.lat(), sw.lng());
			var se = new google.maps.LatLng(sw.lat(), ne.lng());

			for (var i = 0; i < _shipMarkers.length; i++) {
				var marker = _shipMarkers[i];
				//바운드 안에 있는지 파악.- 바운드 안의 마크만 생성, 보여줌
				var markerIsOrNotInBounds = _map.getBounds().contains(marker.getPosition());
				if (markerIsOrNotInBounds) {
					addShipInfo(marker);
				}else{
					//바운드 밖의 마크는 삭제
					removeShipInfo(marker);
				}
			}
		}

		//getPixelOffset 알아내기
		function getPixelOffset(_map, _marker){
			var scale = Math.pow(2, _map.getZoom());
			var nw = new google.maps.LatLng(
				_map.getBounds().getNorthEast().lat(),
				_map.getBounds().getSouthWest().lng()
			);
			var worldCoordinateNW = _map.getProjection().fromLatLngToPoint(nw);			
			var worldCoordinate = _map.getProjection().fromLatLngToPoint(_marker.getPosition());
			var pixelOffset = new google.maps.Point(
				Math.floor((worldCoordinate.x - worldCoordinateNW.x) * scale),
				Math.floor((worldCoordinate.y - worldCoordinateNW.y) * scale)
			);

			return pixelOffset;
		}
		
		//ShipInfo 위치 변경
		function infoOffset(_el, _marker){
			var offset = getPixelOffset(_map, _marker);
			var el = _el.css({
				left: offset.x,
				top : offset.y,
				'marginTop' : "-15px",
				'marginLeft' : "30px"
			});
			return el;
		}

		//ShipInfo삭제
		function removeShipInfo(_marker){
			var mapshipover_id = "MapShip_"+_marker.info.mmsi;
			$("#"+mapshipover_id).remove();			
		}
		
		//ShipInfo 생성
		function addShipInfo(_marker){
			var mapContent = $("#MapContent");
			var info = $(createHTMLShipInfo(_marker.info));
			mapContent.append(infoOffset(info, _marker));
		}

		//ShipInfo 전체 삭제
		function removeAllShipInfo(){
			var mapover_infos = document.querySelectorAll(".MapShipOver");
			if( mapover_infos == null || mapover_infos.length == 0 ) return;
			for( var i =0; i<mapover_infos.length;i++ ){
				if( mapover_infos[i].parentNode ){
					mapover_infos[i].parentNode.removeChild(mapover_infos[i]);
				}
			}
		}

		//ship info html 만들기
		function createHTMLShipInfo(_shipData){
			var html_id = "MapShip_"+_shipData.mmsi;
			var html = "";
			html +='<div class="MapShipOver active" id='+html_id+'>';
			html +='	<div class="MapShipOver__inner">';
			html +='		<div class="MapShipOver__title">';
			html +='		<span class="name">'+_shipData.vessel_name+'</span>';
			html +='		</div>';
			html +='		<div class="MapShipOver__content">';
			html +='		<span>2015 BLT / 308,371 MT / MAX 23.0 MTR</span>';
			html +='		</div>';
			html +='	</div>';
			html +='</div>';
			return html;
		}

		//배 마커 그리기
		function createShipMakers(_map, _data){
			var ship_on = {
				url : '/_public/images/map/icon/icon_ship_on.png',
				scaledSize: new google.maps.Size(42, 42),
				size : new google.maps.Size(56, 56),
				origin : new google.maps.Point(0, 0),
				anchor: new google.maps.Point(25, 14),
			}
			_data.forEach(function(ship){
				//myfleet 이 있을때 밑에 마커를 하나 더 넣음.
				if( ship.myfleet ){
					var makerOn = new google.maps.Marker({
						position: {lat: ship.position_info.lat, lng: ship.position_info.lon},
						map: _map,
						zIndex : 1,
						icon : ship_on
					});
				}
				var marker = new google.maps.Marker({
					info : ship,
					position: {lat: ship.position_info.lat, lng: ship.position_info.lon},
					map: _map,
					zIndex : 2,
					getIcon : function(){
						var icon = window.uiGooglMap.findShipType(ship.ship_type).icon;
						var heading = ship.position_info.true_heading;
						var course = ship.position_info.course;
						var rotation = heading != null ? Math.floor(heading / 10) : course != null && course != '3600' ? Math.floor(course / 10) : 0;
						icon.rotation = rotation * 9;
						icon.size = new google.maps.Point(12, 20);
						icon.anchor = new google.maps.Point(7, 0);
						icon.scale = 0.5;
						return icon;
					}
				});
				marker.addListener('click', function(event) {
					var info = window.uiGooglMap.infoShipMarker();
                    info.open(event.pixel);	
				});	
				marker.addListener('mouseover', function(event) {
					addShipInfo(this);
				});	
				marker.addListener('mouseout', function(event) {
					removeShipInfo(this);
				});
				_shipMarkers.push(marker);
			}); 
		}

		//200403 추가 라인클릭시 정보창 오픈
		var showPathInfo = (function(){
            var infoEl = $("#MapPathLineInfo");
            return{
                open : function(e){
					this.close();
                    infoEl.css({
                        'marginTop' : -(infoEl.height()*2)+"px",
						'left' : (e.x)+7-(infoEl.width()/2)+'px',
						'top' : e.y-7+'px'
                    });
                    infoEl.addClass("active");
                },
                close : function(){
                    infoEl.attr('style', '');
                    infoEl.removeClass("active");
                }
            }
		})();
		
		//라인그리기
		function createLine(_map, _data){
			var path = new google.maps.Polyline({
				path: _data,
				geodesic: true,
				strokeWidth : 10, //라인이 너무 좁으면 마우스 클릭이 잘안되서 넓이 넓혀줌
				strokeOpacity : 0,
				strokeColor : "#FFFFFF",
				icons : [
					{
						icon: {
							path: 'M 0,-1 0,1',
							strokeOpacity: 1,
							scale: 1.2
						},
						offset: '0',
						repeat: '8px'
					}
				]
			});

			//200403 추가 라인클릭시 오픈
			path.addListener('click', function(event){
				showPathInfo.open(event.rb);
			});

			//마우스오버시 색상변경 - 필요 없을시 삭제
			path.addListener("mouseover", function(){
				this.setOptions({
					strokeColor : '#cddc39',
				});
			});
			path.addListener("mouseout", function(){
				this.setOptions({
					strokeColor : '#ffffff'
				});
			});
			path.setMap(_map);
		}
		
		//map 관련 UI 
		function ui_mapDetail(){
			var mapContent = $(".MapDetail__content");
			var mapList = $(".MapDetail__list");
			var onClassName = "active";
			mapList.children("a").on('click', function(e){
				e.preventDefault();
				var href = $(this).attr('href');
				if( $(this).hasClass(onClassName) ){
					$(this).removeClass(onClassName);
					$(href).removeClass(onClassName);			
				}else{
					$(this).addClass(onClassName);
					$(href).addClass(onClassName);
				}
			});
		}

		//윈도우팝업
		function ui_window(_url, _width, _height, _left, _top){
			var popupX = _left != null ? _left : (window.screen.width / 2) - (_width / 2);
			var popupY = _top != null ? _top : (window.screen.height / 2) - (_height / 2);	
			var option="resizable=no, scrollbas=yes,status=no,width="+_width+",height="+_height+",left="+popupX+",top="+popupY;
			window.open(_url, 'portData', option);
		}
	</script>
	<script type="text/javascript" src="../_public/js/ui.gooleMap.js"></script>
	<script type="text/javascript" src="../_public/js/ui.googleMap.sampleData.js"></script>
	<script type="text/javascript" src="../_public/js/sv.map.controller.min.js"></script>
	<script src="http://maps.googleapis.com/maps/api/js?libraries=geometry,drawing&region=en&language=en&key=AIzaSyCQ8LK-VtL1tudKfKMUo-Br9bQNt5u7Cc0&callback=initMap" async defer></script>		
</body>
</html>